{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Reservation #{{ reservation.reservation_id }}</h2>

<div class="row mb-4">
  <div class="col-md-6">
    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <h5 class="card-title">Reservation Info</h5>
        <dl class="row mb-0">
          <dt class="col-sm-4">Student</dt>
          <dd class="col-sm-8">{{ reservation.user.full_name }}</dd>

          <dt class="col-sm-4">Email</dt>
          <dd class="col-sm-8">{{ reservation.user.email }}</dd>

          <dt class="col-sm-4">Start</dt>
          <dd class="col-sm-8">{{ reservation.start_date }}</dd>

          <dt class="col-sm-4">End</dt>
          <dd class="col-sm-8">{{ reservation.end_date }}</dd>

          <dt class="col-sm-4">Status</dt>
          <dd class="col-sm-8">
            <span class="badge
              {% if reservation.status == 'Approved' %}bg-success
              {% elif reservation.status == 'Pending' %}bg-warning text-dark
              {% elif reservation.status == 'Denied' %}bg-danger
              {% else %}bg-secondary{% endif %}">
              {{ reservation.status }}
            </span>
          </dd>
        </dl>
      </div>
    </div>

    {% if reservation.status == 'Approved' and not reservation.loan %}
    <a href="{{ url_for('loans_create', reservation_id=reservation.reservation_id) }}"
       class="btn btn-primary">
      Create Loan from this Reservation
    </a>
    {% elif reservation.loan %}
    <div class="alert alert-info mt-2 mb-0">
      Loan already created: <strong>#{{ reservation.loan.loan_id }}</strong>.
      See the Loans page for details.
    </div>
    {% endif %}
  </div>

  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-body">
        <h5 class="card-title">Requested Equipment</h5>
        {% if reservation.items %}
        <table class="table table-sm mb-0">
          <thead class="table-light">
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Category</th>
              <th>Location</th>
            </tr>
          </thead>
          <tbody>
          {% for item in reservation.items %}
            <tr>
              <td>{{ item.equipment.equipment_id }}</td>
              <td>{{ item.equipment.name }}</td>
              <td>{{ item.equipment.category }}</td>
              <td>{{ item.equipment.location }}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
        {% else %}
        <p class="text-muted mb-0">No equipment items attached to this reservation.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<a href="{{ url_for('reservations_list') }}" class="btn btn-link">&laquo; Back to Reservations</a>
{% endblock %}
